{"ast":null,"code":"import * as AuthActions from './AuthActions';\nexport async function getArtist(artistID) {\n  const accessToken = localStorage.getItem('accessToken');\n  const baseUrl = AuthActions.baseApiUrl + \"/v1/artists\";\n  let response = await fetch(`${baseUrl}/${artistID}`, {\n    headers: {\n      Authorization: `Bearer  ${accessToken}`\n    }\n  });\n  response = await response.json();\n}\nexport async function getSearchResults(searchQuery) {\n  const baseUrl = AuthActions.baseApiUrl + \"/v1/search\";\n  let queryString = new URLSearchParams({\n    q: searchQuery,\n    type: [\"track\"]\n  });\n  if (!localStorage.getItem(\"accessToken\")) await AuthActions.requestAccessToken();\n  const accessToken = localStorage.getItem(\"accessToken\");\n  let i = 0;\n  while (i++ < 10) {\n    let response = await fetch(`${baseUrl}?${queryString.toString()}`, {\n      headers: {\n        Authorization: `Bearer  ${accessToken}`\n      }\n    });\n    if (!response.ok) {\n      console.log(response.status == 401);\n      if (response.status == 401) await AuthActions.requestAccessToken();\n    } else {\n      let data = await response.json();\n      return data.tracks.items;\n    }\n  }\n}\nexport async function getUserInfo() {\n  const baseUrl = AuthActions.baseApiUrl + \"/v1/me\";\n  if (!localStorage.getItem(\"accessToken\")) await requestAccessToken();\n  const accessToken = localStorage.getItem(\"accessToken\");\n  let response = await fetch(baseUrl, {\n    headers: {\n      Authorization: `Bearer  ${accessToken}`\n    }\n  });\n  while (true) {\n    if (!response.ok && response.status == 401) {\n      await AuthActions.requestAccessToken();\n    }\n    let data = await response.json();\n    localStorage.setItem(\"userId\", data.id);\n    return data;\n  }\n}\nexport async function createPlaylist(title) {\n  if (!localStorage.getItem(\"userId\")) await getUserInfo();\n  const userId = localStorage.getItem(\"userId\");\n  const baseUrl = `${baseApiUrl}/v1/users/${userId}/playlists`;\n  const accessToken = localStorage.getItem(\"accessToken\");\n  let body = {\n    name: title\n  };\n  let response = await fetch(baseUrl, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer  ${accessToken}`,\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(body)\n  });\n  let data = await response.json();\n  return data;\n}\nexport async function addToPlaylist(playlistId, tracks) {\n  if (!tracks) return;\n  const baseUrl = `${baseApiUrl}/v1/playlists/${playlistId}/tracks`;\n  const accessToken = localStorage.getItem(\"accessToken\");\n  let body = {\n    uris: tracks.map(track => track.uri)\n  };\n  let response = await fetch(baseUrl, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer  ${accessToken}`,\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(body)\n  });\n  let data = await response.json();\n  return data;\n}","map":{"version":3,"names":["AuthActions","getArtist","artistID","accessToken","localStorage","getItem","baseUrl","baseApiUrl","response","fetch","headers","Authorization","json","getSearchResults","searchQuery","queryString","URLSearchParams","q","type","requestAccessToken","i","toString","ok","console","log","status","data","tracks","items","getUserInfo","setItem","id","createPlaylist","title","userId","body","name","method","JSON","stringify","addToPlaylist","playlistId","uris","map","track","uri"],"sources":["/home/linkachu/jammming/src/Spotify.js"],"sourcesContent":["import * as AuthActions from './AuthActions'\n\nexport async function getArtist(artistID){\n    const accessToken = localStorage.getItem('accessToken')\n    const baseUrl = AuthActions.baseApiUrl + \"/v1/artists\";\n\n    let response = await fetch(`${baseUrl}/${artistID}`, {\n        headers: {\n            Authorization: `Bearer  ${accessToken}`\n        }\n    });\n    response = await response.json();\n}\n\nexport async function getSearchResults(searchQuery){\n    const baseUrl = AuthActions.baseApiUrl + \"/v1/search\";\n\n    let queryString = new URLSearchParams({\n        q: searchQuery,\n        type: [\n            \"track\"\n        ]\n    })\n\n    if (!localStorage.getItem(\"accessToken\"))\n        await AuthActions.requestAccessToken();\n\n    const accessToken = localStorage.getItem(\"accessToken\");\n\n    let i = 0\n    while (i++ < 10){\n        let response = await fetch(`${baseUrl}?${queryString.toString()}`, {\n            headers: {\n                Authorization: `Bearer  ${accessToken}`\n            }\n        });\n\n        if(!response.ok){\n            console.log(response.status == 401);\n            if(response.status == 401)\n                await AuthActions.requestAccessToken();\n        } else {\n            let data = await response.json();\n            return data.tracks.items;\n        }\n    }\n}\n\nexport async function getUserInfo(){\n    const baseUrl = AuthActions.baseApiUrl + \"/v1/me\";\n\n    if (!localStorage.getItem(\"accessToken\"))\n        await requestAccessToken();\n\n    const accessToken = localStorage.getItem(\"accessToken\");\n    \n    let response = await fetch(baseUrl, {\n        headers: {\n          Authorization: `Bearer  ${accessToken}`\n        }\n    });\n\n    while (true){\n        if(!response.ok && response.status == 401){\n            await AuthActions.requestAccessToken();\n\n        }\n        \n        let data = await response.json();\n        \n        localStorage.setItem(\"userId\", data.id)\n        \n        return data;\n    }\n}\n\nexport async function createPlaylist(title){\n    if(!localStorage.getItem(\"userId\"))\n        await getUserInfo();\n\n    const userId = localStorage.getItem(\"userId\");\n    const baseUrl = `${baseApiUrl}/v1/users/${userId}/playlists`;\n\n    const accessToken = localStorage.getItem(\"accessToken\");\n\n    let body = {\n        name: title\n    };\n\n    let response = await fetch(baseUrl, {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer  ${accessToken}`,\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(body)\n    });\n\n    let data = await response.json();\n\n    return data;\n}\n\nexport async function addToPlaylist(playlistId, tracks){\n    if(!tracks)\n        return;\n\n    const baseUrl = `${baseApiUrl}/v1/playlists/${playlistId}/tracks`;\n\n    const accessToken = localStorage.getItem(\"accessToken\");\n\n    let body = {\n        uris: tracks.map((track) => track.uri)\n    };\n\n    let response = await fetch(baseUrl, {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer  ${accessToken}`,\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(body)\n    });\n\n    let data = await response.json();\n\n    return data;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}